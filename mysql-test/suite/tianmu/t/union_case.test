--source include/have_tianmu.inc
--echo # MCOL-641 Union Test Cases
--echo # Once MCOL-5417 is supported, the errored out queries below should be fixed.

--disable_warnings
DROP DATABASE IF EXISTS union_case_test;
--enable_warnings

CREATE DATABASE union_case_test;
USE union_case_test;

SET SQL_MODE='ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION';

CREATE TABLE cs1 (d1 DECIMAL(17), d2 DECIMAL(17,10), d3 DECIMAL(17,17)) ;
CREATE TABLE cs2 (d1 DECIMAL(17) UNSIGNED, d2 DECIMAL(17,10) UNSIGNED, d3 DECIMAL(17,17) UNSIGNED) ;

INSERT INTO cs1 VALUES (125, 1.25, 0.125);
INSERT INTO cs1 VALUES (-125, -1.25, -0.125);
INSERT INTO cs1 values (9999999999999998, 9999999.9999999998, 0.9999999999999998);
INSERT INTO cs1 values (99999999999999999, 9999999.9999999999, 0.99999999999999999);
INSERT INTO cs1 values (-9999999999999998, -9999999.9999999998, -0.9999999999999998);
INSERT INTO cs1 values (-99999999999999999, -9999999.9999999999, -0.99999999999999999);
#bug1868 select * from  cs1;
#bug1870 SELECT d1, d2, d3 FROM cs1 UNION SELECT d1, d2, d3 FROM cs1;

CREATE TABLE cs3 (d1 int, d2 int, d3 int) ;
INSERT INTO cs3 VALUES (12, 16, 56);
INSERT INTO cs3 VALUES (7, 6, 45);
INSERT INTO cs3 VALUES (0, 0, 0);
SELECT d1, d1, d2 FROM cs3 UNION SELECT d2, d3, d3 FROM cs3;

INSERT INTO cs2 VALUES (125, 1.25, 0.125);
INSERT INTO cs2 values (9999999999999998, 9999999.9999999998, 0.9999999999999998);
INSERT INTO cs2 values (99999999999999999, 9999999.9999999999, 0.99999999999999999);

#bug1870  SELECT d1, d2, d3 FROM cs2 UNION SELECT d1, d2, d3 FROM cs2;

DROP TABLE cs1, cs2;
CREATE TABLE cs1 (d1 DECIMAL(17, 0), d2 DECIMAL(17, 14), d3 DECIMAL(17, 14)) ;
CREATE TABLE cs2 (d1 DECIMAL(17, 0) UNSIGNED, d2 DECIMAL(17, 14) UNSIGNED, d3 DECIMAL(17, 14) UNSIGNED) ;
INSERT INTO cs1 VALUES (12345678901234567, 12.34567890123456, 0.1234567890123456);
INSERT INTO cs1 VALUES (-12345678901234567, -12.34567890123456, -0.1234567890123456);
INSERT INTO cs1 VALUES (99999999999999999, 99.999999999999999, 0.999999999999999);
INSERT INTO cs1 VALUES (-99999999999999999, -99.999999999999999, -0.999999999999999);
INSERT INTO cs2 VALUES (12345678901234567, 12.34567890123456, 0.1234567890123456);
INSERT INTO cs2 VALUES (99999999999999999, 99.999999999999999, 0.999999999999999);

#bug1870 SELECT d1, d1, d2 FROM cs1 UNION SELECT d2, d3, d3 FROM cs1;

# Clean UP
DROP DATABASE union_case_test;
