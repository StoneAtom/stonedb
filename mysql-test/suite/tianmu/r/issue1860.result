DROP DATABASE IF EXISTS issue1860_test;
CREATE DATABASE issue1860_test;
USE issue1860_test;
CREATE TABLE tt(id decimal(18,0), dt datetime) ENGINE =TIANMU;
INSERT INTO  tt VALUES(1111.0, '2023-01-01');
SELECT id FROM tt UNION SELECT 2222 c1 FROM dual;
id
1111
2222
INSERT INTO tt VALUES(2222.0, '2023-02-02');
SELECT id FROM tt UNION SELECT 2222 c1 FROM dual;
id
1111
2222
SELECT id FROM tt UNION ALL SELECT 2222 c1 FROM dual;
id
1111
2222
2222
SELECT id FROM tt UNION SELECT 2222 ;
id
1111
2222
sELECT id FROM tt UNION ALL SELECT 2222;
id
1111
2222
2222
SELECT id, dt FROM tt UNION SELECT 2222, '2022-01-01';
id	dt
1111	2023-01-01 00:00:00
2222	2023-02-02 00:00:00
2222	2022-01-01
SELECT id, dt FROM tt UNION SELECT 2222, str_to_date('2022-02-03', '%Y-%m-%d');
id	dt
1111	2023-01-01 00:00:00
2222	2023-02-02 00:00:00
2222	2022-02-03 00:00:00
SELECT id, dt FROM tt UNION SELECT 2222, str_to_date('2023-02-02', '%Y-%m-%d');
id	dt
1111	2023-01-01 00:00:00
2222	2023-02-02 00:00:00
SELECT dt FROM tt UNION SELECT 2222;
ERROR HY000: wrong types of columns
SELECT dt FROM tt UNION SELECT '2222';
dt
2023-01-01 00:00:00
2023-02-02 00:00:00
2222
SELECT * FROM tt UNION SELECT 222;
ERROR 21000: The used SELECT statements have a different number of columns
SELECT * FROM tt UNION ALL SELECT 222;
ERROR 21000: The used SELECT statements have a different number of columns
DROP TABLE tt;
DROP DATABASE issue1860_test;
